<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nekotina - Secure Access</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: #050505;
            overflow: hidden;
        }

        .mesh-gradient {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: 
                radial-gradient(at 0% 0%, rgba(157, 78, 221, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(90, 24, 154, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(60, 9, 108, 0.15) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(123, 44, 191, 0.1) 0px, transparent 50%);
            z-index: -1;
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .input-group:focus-within {
            border-color: #9d4edd;
            box-shadow: 0 0 0 2px rgba(157, 78, 221, 0.2);
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .fade-slide-in {
            animation: fadeSlide 0.5s ease-out forwards;
        }

        @keyframes fadeSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="mesh-gradient"></div>
    
    <div id="toast-container"></div>

    <main class="glass w-full max-w-[420px] rounded-[32px] p-8 relative overflow-hidden fade-slide-in">
        <!-- Logo/Header -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-tr from-[#5a189a] to-[#9d4edd] mb-4 shadow-lg shadow-purple-500/20">
                <i data-lucide="shield-check" class="text-white w-8 h-8"></i>
            </div>
            <h1 class="text-2xl font-bold text-white tracking-tight">Nekotina System</h1>
            <p class="text-gray-400 text-sm mt-1">Gerenciamento Seguro de RDP</p>
        </div>

        <!-- FORMULÁRIO DE LOGIN -->
        <div id="login-view" class="space-y-4">
            <div class="space-y-1">
                <label class="text-xs font-semibold text-gray-400 ml-1">USUÁRIO</label>
                <div class="input-group flex items-center bg-white/5 border border-white/10 rounded-xl px-4 py-3 transition-all">
                    <i data-lucide="user" class="w-4 h-4 text-gray-500 mr-3"></i>
                    <input type="text" id="login-user" class="bg-transparent border-none outline-none text-white text-sm w-full placeholder:text-gray-600" placeholder="Digite seu usuário">
                </div>
            </div>

            <div class="space-y-1">
                <label class="text-xs font-semibold text-gray-400 ml-1">SENHA</label>
                <div class="input-group flex items-center bg-white/5 border border-white/10 rounded-xl px-4 py-3 transition-all">
                    <i data-lucide="lock" class="w-4 h-4 text-gray-500 mr-3"></i>
                    <input type="password" id="login-pass" class="bg-transparent border-none outline-none text-white text-sm w-full placeholder:text-gray-600" placeholder="••••••••">
                </div>
            </div>

            <!-- Captcha -->
            <div class="bg-purple-500/5 border border-purple-500/10 rounded-xl p-4 flex items-center justify-between mt-6">
                <div class="text-sm">
                    <span class="text-gray-400">Verificação:</span>
                    <span id="captcha-text" class="text-purple-400 font-bold ml-1"></span>
                </div>
                <input type="number" id="captcha-input" class="w-16 bg-white/5 border border-white/10 rounded-lg px-2 py-1 text-center text-white outline-none focus:border-purple-500">
            </div>

            <button onclick="handleLogin()" id="btn-login" class="w-full bg-gradient-to-r from-[#7b2cbf] to-[#9d4edd] hover:from-[#9d4edd] hover:to-[#c77dff] text-white font-semibold py-3.5 rounded-xl transition-all shadow-lg shadow-purple-500/25 active:scale-95 mt-4">
                Entrar no Painel
            </button>

            <p class="text-center text-sm text-gray-500 mt-6">
                Não tem conta? 
                <button onclick="toggleView()" class="text-purple-400 font-semibold hover:underline">Registre-se</button>
            </p>
        </div>

        <!-- FORMULÁRIO DE REGISTRO -->
        <div id="register-view" class="space-y-4 hidden">
            <div class="space-y-1">
                <label class="text-xs font-semibold text-gray-400 ml-1">NOVO USUÁRIO</label>
                <div class="input-group flex items-center bg-white/5 border border-white/10 rounded-xl px-4 py-3 transition-all">
                    <i data-lucide="user-plus" class="w-4 h-4 text-gray-500 mr-3"></i>
                    <input type="text" id="reg-user" class="bg-transparent border-none outline-none text-white text-sm w-full placeholder:text-gray-600" placeholder="Escolha um nome">
                </div>
            </div>

            <div class="space-y-1">
                <label class="text-xs font-semibold text-gray-400 ml-1">SENHA</label>
                <div class="input-group flex items-center bg-white/5 border border-white/10 rounded-xl px-4 py-3 transition-all">
                    <i data-lucide="key" class="w-4 h-4 text-gray-500 mr-3"></i>
                    <input type="password" id="reg-pass" class="bg-transparent border-none outline-none text-white text-sm w-full placeholder:text-gray-600" placeholder="Crie uma senha forte">
                </div>
            </div>

            <div class="space-y-1">
                <label class="text-xs font-semibold text-gray-400 ml-1">LINK DO GRUPO</label>
                <div class="input-group flex items-center bg-white/5 border border-white/10 rounded-xl px-4 py-3 transition-all">
                    <i data-lucide="link" class="w-4 h-4 text-gray-500 mr-3"></i>
                    <input type="text" id="reg-link" class="bg-transparent border-none outline-none text-white text-sm w-full placeholder:text-gray-600" placeholder="https://t.me/seu-grupo">
                </div>
            </div>

            <button onclick="handleRegister()" id="btn-reg" class="w-full bg-white/10 hover:bg-white/20 text-white font-semibold py-3.5 rounded-xl transition-all active:scale-95 mt-4">
                Criar Conta Agora
            </button>

            <button onclick="toggleView()" class="w-full text-center text-sm text-gray-500 hover:text-gray-300 transition-colors">
                Voltar para o Login
            </button>
        </div>

        <footer class="mt-8 pt-6 border-t border-white/5 text-[10px] text-center text-gray-600 uppercase tracking-widest">
            Nekotina Database &copy; 2026 • Restricted Administrator
        </footer>
    </main>

    <script>
        // Configurações
        const BRIDGE_URL = 'https://meristic-unironical-gail.ngrok-free.dev';
        let n1, n2;

        // Inicializar ícones
        lucide.createIcons();

        // Gerar Captcha
        function generateCaptcha() {
            n1 = Math.floor(Math.random() * 9) + 1;
            n2 = Math.floor(Math.random() * 9) + 1;
            document.getElementById('captcha-text').innerText = `${n1} + ${n2} = ?`;
        }
        generateCaptcha();

        function toggleView() {
            const login = document.getElementById('login-view');
            const register = document.getElementById('register-view');
            login.classList.toggle('hidden');
            register.classList.toggle('hidden');
        }

        function showToast(msg, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const colors = {
                error: 'bg-red-500',
                success: 'bg-green-500',
                info: 'bg-purple-500'
            };
            
            toast.className = `${colors[type]} text-white px-6 py-3 rounded-2xl shadow-xl text-sm font-bold mb-3 fade-slide-in flex items-center`;
            toast.innerHTML = `<i data-lucide="info" class="w-4 h-4 mr-2"></i> ${msg}`;
            container.appendChild(toast);
            lucide.createIcons();
            
            setTimeout(() => toast.remove(), 4000);
        }

        async function handleLogin() {
            const user = document.getElementById('login-user').value;
            const pass = document.getElementById('login-pass').value;
            const captcha = parseInt(document.getElementById('captcha-input').value);
            const btn = document.getElementById('btn-login');

            if (!user || !pass) return showToast("Preencha todos os campos", "error");
            if (captcha !== (n1 + n2)) return showToast("Captcha incorreto", "error");

            btn.disabled = true;
            btn.innerHTML = '<span class="flex items-center justify-center"><i data-lucide="loader-2" class="w-4 h-4 animate-spin mr-2"></i> Autenticando...</span>';
            lucide.createIcons();

            try {
                // Fetch buscando do seu ngrok
                const response = await fetch(BRIDGE_URL, {
                    headers: { 'ngrok-skip-browser-warning': 'true' }
                });
                
                if (!response.ok) throw new Error();
                const db = await response.json();
                
                // Validação
                const match = db.find(u => u.usuario === user && u.senha === pass);

                if (match) {
                    showToast("Acesso autorizado! Redirecionando...", "success");
                    localStorage.setItem('nekotina_session', JSON.stringify(match));
                    setTimeout(() => window.location.href = 'dashboard.html', 1500);
                } else {
                    showToast("Usuário ou senha incorretos", "error");
                    btn.disabled = false;
                    btn.innerText = "Entrar no Painel";
                }
            } catch (err) {
                showToast("Erro ao conectar à ponte RDP", "error");
                btn.disabled = false;
                btn.innerText = "Entrar no Painel";
            }
        }

        async function handleRegister() {
            const user = document.getElementById('reg-user').value;
            const pass = document.getElementById('reg-pass').value;
            const link = document.getElementById('reg-link').value;
            const btn = document.getElementById('btn-reg');

            if (!user || !pass || !link) return showToast("Preencha todos os campos", "error");

            btn.disabled = true;
            btn.innerText = "Processando...";

            try {
                const response = await fetch(BRIDGE_URL, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({ usuario: user, senha: pass, link_grupo: link })
                });

                if (response.ok) {
                    showToast("Conta criada com sucesso!", "success");
                    setTimeout(toggleView, 1500);
                } else {
                    const data = await response.json();
                    showToast(data.erro || "Erro ao registrar", "error");
                }
            } catch (err) {
                showToast("Falha na comunicação", "error");
            } finally {
                btn.disabled = false;
                btn.innerText = "Criar Conta Agora";
            }
        }
    </script>
</body>
</html>
